
      - job: BuildAndPublishSAPMockService
        workspace:
          clean: all
        displayName: "Dotnet Build publish SAP Mock Service"
        steps:

          - task: NuGetToolInstaller@0
            displayName: 'Use NuGet 6.0.0'
            inputs:
              versionSpec: 6.0.0

          - task: NuGetRestore@1
            displayName: 'NuGet restore using NuGet.config'
            inputs:
              solution: '$(Build.SourcesDirectory)\UKHO.SAP.MockService\UKHO.SAP.MockService.sln'
              selectOrConfig: config
              nugetConfigPath: NuGet.config
              noCache: true

          - task: VSBuild@1
            displayName: 'Build Mock API Solution'
            inputs:
              solution: '$(Build.SourcesDirectory)\UKHO.SAP.MockService\UKHO.SAP.MockService.sln'
              vsVersion: 17.0
              platform: '$(BuildPlatform)'
              configuration: '$(BuildConfiguration)'
              clean: true

          - task: CopyFiles@2
            displayName: 'Copy Files to: $(build.artifactstagingdirectory)'
            inputs:
              SourceFolder: '$(Build.SourcesDirectory)'
              Contents: 'UKHO.SAP.MockService\src\UKHO.SAP.MockService\bin\**'
              TargetFolder: '$(build.artifactstagingdirectory)'

          - task: ArchiveFiles@2
            displayName: 'Archive Files for Mock API package'
            inputs:
              rootFolderOrFile: '$(build.artifactstagingdirectory)\UKHO.SAP.MockService\src\UKHO.SAP.MockService\bin'
              includeRootFolder: false
              archiveFile: '$(build.artifactstagingdirectory)\UKHO.SAP.MockService.zip'

          - task: PublishBuildArtifacts@1
            displayName: 'Publish Artifact: UKHO.SAP.MockService'
            inputs:
              PathtoPublish: '$(Build.ArtifactStagingDirectory)\UKHO.SAP.MockService.zip'
              ArtifactName: UKHOSAPMockService